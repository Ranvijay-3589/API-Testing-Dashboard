{"ast":null,"code":"import { cloneDeep } from '@swagger-api/apidom-core';\nimport NormalizeStorage from \"./normalize-header-examples/NormalizeStorage.mjs\";\n/**\n * Override of Schema.example and Schema.examples field inside the Parameter Objects.\n *\n * Parameter Object has two fixed fields:\n *  - `example` of type `Any`\n *  - `examples` of type `Map[string, Example Object | Reference Object]`\n *\n * OpenAPI 3.1 specification excerpt that defines the override behavior:\n *\n * The example value SHALL override the example provided by the schema.\n * Furthermore, if referencing a schema that contains an example, the examples value SHALL override the example provided by the schema.\n *\n * NOTE: this plugin is idempotent\n * @public\n */\n/**\n * @public\n */\nconst plugin = function () {\n  let {\n    storageField = 'x-normalized'\n  } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return toolbox => {\n    const {\n      predicates,\n      ancestorLineageToJSONPointer\n    } = toolbox;\n    let storage;\n    return {\n      visitor: {\n        OpenApi3_1Element: {\n          enter(element) {\n            storage = new NormalizeStorage(element, storageField, 'parameter-examples');\n          },\n          leave() {\n            storage = undefined;\n          }\n        },\n        ParameterElement: {\n          leave(parameterElement, key, parent, path, ancestors) {\n            var _parameterElement$sch, _parameterElement$sch2;\n            // skip visiting this Parameter Object\n            if (ancestors.some(predicates.isComponentsElement)) {\n              return;\n            }\n\n            // no Parameter.schema field present\n            if (typeof parameterElement.schema === 'undefined' || !predicates.isSchemaElement(parameterElement.schema)) {\n              return;\n            }\n            // Schema contains no example\n            if (typeof ((_parameterElement$sch = parameterElement.schema) === null || _parameterElement$sch === void 0 ? void 0 : _parameterElement$sch.example) === 'undefined' && typeof ((_parameterElement$sch2 = parameterElement.schema) === null || _parameterElement$sch2 === void 0 ? void 0 : _parameterElement$sch2.examples) === 'undefined') {\n              return;\n            }\n            const parameterJSONPointer = ancestorLineageToJSONPointer([...ancestors, parent, parameterElement]);\n\n            // skip visiting this Parameter Object if it's already normalized\n            if (storage.includes(parameterJSONPointer)) {\n              return;\n            }\n\n            /**\n             * Parameter.examples and Schema.examples have preferences over the older\n             * and deprected `example` field.\n             */\n            if (typeof parameterElement.examples !== 'undefined' && predicates.isObjectElement(parameterElement.examples)) {\n              // @ts-ignore\n              const examples = parameterElement.examples.map(example => {\n                return cloneDeep.safe(example.value);\n              });\n              if (typeof parameterElement.schema.examples !== 'undefined') {\n                parameterElement.schema.set('examples', examples);\n                storage.append(parameterJSONPointer);\n              }\n              if (typeof parameterElement.schema.example !== 'undefined') {\n                parameterElement.schema.set('example', examples[0]);\n                storage.append(parameterJSONPointer);\n              }\n              return;\n            }\n\n            /**\n             * Handle deprecated `example` field.\n             */\n            if (typeof parameterElement.example !== 'undefined') {\n              if (typeof parameterElement.schema.examples !== 'undefined') {\n                parameterElement.schema.set('examples', [cloneDeep(parameterElement.example)]);\n                storage.append(parameterJSONPointer);\n              }\n              if (typeof parameterElement.schema.example !== 'undefined') {\n                parameterElement.schema.set('example', cloneDeep(parameterElement.example));\n                storage.append(parameterJSONPointer);\n              }\n            }\n          }\n        }\n      }\n    };\n  };\n};\nexport default plugin;","map":{"version":3,"names":["cloneDeep","NormalizeStorage","plugin","storageField","arguments","length","undefined","toolbox","predicates","ancestorLineageToJSONPointer","storage","visitor","OpenApi3_1Element","enter","element","leave","ParameterElement","parameterElement","key","parent","path","ancestors","_parameterElement$sch","_parameterElement$sch2","some","isComponentsElement","schema","isSchemaElement","example","examples","parameterJSONPointer","includes","isObjectElement","map","safe","value","set","append"],"sources":["/var/www/ranvijay.capricorn.online/mohit/frontend/node_modules/@swagger-api/apidom-ns-openapi-3-1/src/refractor/plugins/normalize-parameter-examples.mjs"],"sourcesContent":["import { cloneDeep } from '@swagger-api/apidom-core';\nimport NormalizeStorage from \"./normalize-header-examples/NormalizeStorage.mjs\";\n/**\n * Override of Schema.example and Schema.examples field inside the Parameter Objects.\n *\n * Parameter Object has two fixed fields:\n *  - `example` of type `Any`\n *  - `examples` of type `Map[string, Example Object | Reference Object]`\n *\n * OpenAPI 3.1 specification excerpt that defines the override behavior:\n *\n * The example value SHALL override the example provided by the schema.\n * Furthermore, if referencing a schema that contains an example, the examples value SHALL override the example provided by the schema.\n *\n * NOTE: this plugin is idempotent\n * @public\n */\n/**\n * @public\n */\nconst plugin = ({\n  storageField = 'x-normalized'\n} = {}) => toolbox => {\n  const {\n    predicates,\n    ancestorLineageToJSONPointer\n  } = toolbox;\n  let storage;\n  return {\n    visitor: {\n      OpenApi3_1Element: {\n        enter(element) {\n          storage = new NormalizeStorage(element, storageField, 'parameter-examples');\n        },\n        leave() {\n          storage = undefined;\n        }\n      },\n      ParameterElement: {\n        leave(parameterElement, key, parent, path, ancestors) {\n          var _parameterElement$sch, _parameterElement$sch2;\n          // skip visiting this Parameter Object\n          if (ancestors.some(predicates.isComponentsElement)) {\n            return;\n          }\n\n          // no Parameter.schema field present\n          if (typeof parameterElement.schema === 'undefined' || !predicates.isSchemaElement(parameterElement.schema)) {\n            return;\n          }\n          // Schema contains no example\n          if (typeof ((_parameterElement$sch = parameterElement.schema) === null || _parameterElement$sch === void 0 ? void 0 : _parameterElement$sch.example) === 'undefined' && typeof ((_parameterElement$sch2 = parameterElement.schema) === null || _parameterElement$sch2 === void 0 ? void 0 : _parameterElement$sch2.examples) === 'undefined') {\n            return;\n          }\n          const parameterJSONPointer = ancestorLineageToJSONPointer([...ancestors, parent, parameterElement]);\n\n          // skip visiting this Parameter Object if it's already normalized\n          if (storage.includes(parameterJSONPointer)) {\n            return;\n          }\n\n          /**\n           * Parameter.examples and Schema.examples have preferences over the older\n           * and deprected `example` field.\n           */\n          if (typeof parameterElement.examples !== 'undefined' && predicates.isObjectElement(parameterElement.examples)) {\n            // @ts-ignore\n            const examples = parameterElement.examples.map(example => {\n              return cloneDeep.safe(example.value);\n            });\n            if (typeof parameterElement.schema.examples !== 'undefined') {\n              parameterElement.schema.set('examples', examples);\n              storage.append(parameterJSONPointer);\n            }\n            if (typeof parameterElement.schema.example !== 'undefined') {\n              parameterElement.schema.set('example', examples[0]);\n              storage.append(parameterJSONPointer);\n            }\n            return;\n          }\n\n          /**\n           * Handle deprecated `example` field.\n           */\n          if (typeof parameterElement.example !== 'undefined') {\n            if (typeof parameterElement.schema.examples !== 'undefined') {\n              parameterElement.schema.set('examples', [cloneDeep(parameterElement.example)]);\n              storage.append(parameterJSONPointer);\n            }\n            if (typeof parameterElement.schema.example !== 'undefined') {\n              parameterElement.schema.set('example', cloneDeep(parameterElement.example));\n              storage.append(parameterJSONPointer);\n            }\n          }\n        }\n      }\n    }\n  };\n};\nexport default plugin;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}