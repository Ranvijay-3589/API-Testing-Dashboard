{"ast":null,"code":"import { OperationSecurityElement } from '@swagger-api/apidom-ns-openapi-3-0';\nimport NormalizeStorage from \"./normalize-header-examples/NormalizeStorage.mjs\";\n/**\n * Override of Security Requirement Objects.\n *\n * OpenAPI 3.1 specification excerpt that defines the override behavior:\n *\n * Operation.security definition overrides any declared top-level security.\n * To remove a top-level security declaration, an empty array can be used.\n * When a list of Security Requirement Objects is defined on the OpenAPI Object or Operation Object,\n * only one of the Security Requirement Objects in the list needs to be satisfied to authorize the request.\n *\n * NOTE: this plugin is idempotent\n * @public\n */\n/* eslint-disable no-param-reassign */\n/**\n * @public\n */\nconst plugin = function () {\n  let {\n    storageField = 'x-normalized'\n  } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return toolbox => {\n    const {\n      predicates,\n      ancestorLineageToJSONPointer\n    } = toolbox;\n    let topLevelSecurity;\n    let storage;\n    return {\n      visitor: {\n        OpenApi3_1Element: {\n          enter(openapiElement) {\n            storage = new NormalizeStorage(openapiElement, storageField, 'security-requirements');\n            if (predicates.isArrayElement(openapiElement.security)) {\n              topLevelSecurity = openapiElement.security;\n            }\n          },\n          leave() {\n            storage = undefined;\n            topLevelSecurity = undefined;\n          }\n        },\n        OperationElement: {\n          leave(operationElement, key, parent, path, ancestors) {\n            // skip visiting this Operation\n            if (ancestors.some(predicates.isComponentsElement)) {\n              return;\n            }\n            const operationJSONPointer = ancestorLineageToJSONPointer([...ancestors, parent, operationElement]);\n\n            // skip visiting this Operation Object if it's already normalized\n            if (storage.includes(operationJSONPointer)) {\n              return;\n            }\n            const missingOperationLevelSecurity = typeof operationElement.security === 'undefined';\n            const hasTopLevelSecurity = typeof topLevelSecurity !== 'undefined';\n            if (missingOperationLevelSecurity && hasTopLevelSecurity) {\n              var _topLevelSecurity;\n              operationElement.security = new OperationSecurityElement((_topLevelSecurity = topLevelSecurity) === null || _topLevelSecurity === void 0 ? void 0 : _topLevelSecurity.content);\n              storage.append(operationJSONPointer);\n            }\n          }\n        }\n      }\n    };\n  };\n};\n/* eslint-enable */\n\nexport default plugin;","map":{"version":3,"names":["OperationSecurityElement","NormalizeStorage","plugin","storageField","arguments","length","undefined","toolbox","predicates","ancestorLineageToJSONPointer","topLevelSecurity","storage","visitor","OpenApi3_1Element","enter","openapiElement","isArrayElement","security","leave","OperationElement","operationElement","key","parent","path","ancestors","some","isComponentsElement","operationJSONPointer","includes","missingOperationLevelSecurity","hasTopLevelSecurity","_topLevelSecurity","content","append"],"sources":["/var/www/ranvijay.capricorn.online/mohit/frontend/node_modules/@swagger-api/apidom-ns-openapi-3-1/src/refractor/plugins/normalize-security-requirements.mjs"],"sourcesContent":["import { OperationSecurityElement } from '@swagger-api/apidom-ns-openapi-3-0';\nimport NormalizeStorage from \"./normalize-header-examples/NormalizeStorage.mjs\";\n/**\n * Override of Security Requirement Objects.\n *\n * OpenAPI 3.1 specification excerpt that defines the override behavior:\n *\n * Operation.security definition overrides any declared top-level security.\n * To remove a top-level security declaration, an empty array can be used.\n * When a list of Security Requirement Objects is defined on the OpenAPI Object or Operation Object,\n * only one of the Security Requirement Objects in the list needs to be satisfied to authorize the request.\n *\n * NOTE: this plugin is idempotent\n * @public\n */\n/* eslint-disable no-param-reassign */\n/**\n * @public\n */\nconst plugin = ({\n  storageField = 'x-normalized'\n} = {}) => toolbox => {\n  const {\n    predicates,\n    ancestorLineageToJSONPointer\n  } = toolbox;\n  let topLevelSecurity;\n  let storage;\n  return {\n    visitor: {\n      OpenApi3_1Element: {\n        enter(openapiElement) {\n          storage = new NormalizeStorage(openapiElement, storageField, 'security-requirements');\n          if (predicates.isArrayElement(openapiElement.security)) {\n            topLevelSecurity = openapiElement.security;\n          }\n        },\n        leave() {\n          storage = undefined;\n          topLevelSecurity = undefined;\n        }\n      },\n      OperationElement: {\n        leave(operationElement, key, parent, path, ancestors) {\n          // skip visiting this Operation\n          if (ancestors.some(predicates.isComponentsElement)) {\n            return;\n          }\n          const operationJSONPointer = ancestorLineageToJSONPointer([...ancestors, parent, operationElement]);\n\n          // skip visiting this Operation Object if it's already normalized\n          if (storage.includes(operationJSONPointer)) {\n            return;\n          }\n          const missingOperationLevelSecurity = typeof operationElement.security === 'undefined';\n          const hasTopLevelSecurity = typeof topLevelSecurity !== 'undefined';\n          if (missingOperationLevelSecurity && hasTopLevelSecurity) {\n            var _topLevelSecurity;\n            operationElement.security = new OperationSecurityElement((_topLevelSecurity = topLevelSecurity) === null || _topLevelSecurity === void 0 ? void 0 : _topLevelSecurity.content);\n            storage.append(operationJSONPointer);\n          }\n        }\n      }\n    }\n  };\n};\n/* eslint-enable */\n\nexport default plugin;"],"mappings":"AAAA,SAASA,wBAAwB,QAAQ,oCAAoC;AAC7E,OAAOC,gBAAgB,MAAM,kDAAkD;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,MAAM,GAAG,SAAAA,CAAA;EAAA,IAAC;IACdC,YAAY,GAAG;EACjB,CAAC,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,CAAC,CAAC;EAAA,OAAKG,OAAO,IAAI;IACpB,MAAM;MACJC,UAAU;MACVC;IACF,CAAC,GAAGF,OAAO;IACX,IAAIG,gBAAgB;IACpB,IAAIC,OAAO;IACX,OAAO;MACLC,OAAO,EAAE;QACPC,iBAAiB,EAAE;UACjBC,KAAKA,CAACC,cAAc,EAAE;YACpBJ,OAAO,GAAG,IAAIV,gBAAgB,CAACc,cAAc,EAAEZ,YAAY,EAAE,uBAAuB,CAAC;YACrF,IAAIK,UAAU,CAACQ,cAAc,CAACD,cAAc,CAACE,QAAQ,CAAC,EAAE;cACtDP,gBAAgB,GAAGK,cAAc,CAACE,QAAQ;YAC5C;UACF,CAAC;UACDC,KAAKA,CAAA,EAAG;YACNP,OAAO,GAAGL,SAAS;YACnBI,gBAAgB,GAAGJ,SAAS;UAC9B;QACF,CAAC;QACDa,gBAAgB,EAAE;UAChBD,KAAKA,CAACE,gBAAgB,EAAEC,GAAG,EAAEC,MAAM,EAAEC,IAAI,EAAEC,SAAS,EAAE;YACpD;YACA,IAAIA,SAAS,CAACC,IAAI,CAACjB,UAAU,CAACkB,mBAAmB,CAAC,EAAE;cAClD;YACF;YACA,MAAMC,oBAAoB,GAAGlB,4BAA4B,CAAC,CAAC,GAAGe,SAAS,EAAEF,MAAM,EAAEF,gBAAgB,CAAC,CAAC;;YAEnG;YACA,IAAIT,OAAO,CAACiB,QAAQ,CAACD,oBAAoB,CAAC,EAAE;cAC1C;YACF;YACA,MAAME,6BAA6B,GAAG,OAAOT,gBAAgB,CAACH,QAAQ,KAAK,WAAW;YACtF,MAAMa,mBAAmB,GAAG,OAAOpB,gBAAgB,KAAK,WAAW;YACnE,IAAImB,6BAA6B,IAAIC,mBAAmB,EAAE;cACxD,IAAIC,iBAAiB;cACrBX,gBAAgB,CAACH,QAAQ,GAAG,IAAIjB,wBAAwB,CAAC,CAAC+B,iBAAiB,GAAGrB,gBAAgB,MAAM,IAAI,IAAIqB,iBAAiB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,iBAAiB,CAACC,OAAO,CAAC;cAC9KrB,OAAO,CAACsB,MAAM,CAACN,oBAAoB,CAAC;YACtC;UACF;QACF;MACF;IACF,CAAC;EACH,CAAC;AAAA;AACD;;AAEA,eAAezB,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}