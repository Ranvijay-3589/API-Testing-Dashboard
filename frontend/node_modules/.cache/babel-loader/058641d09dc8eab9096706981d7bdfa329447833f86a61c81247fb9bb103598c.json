{"ast":null,"code":"import { PathItemServersElement, OperationServersElement, ServersElement } from '@swagger-api/apidom-ns-openapi-3-0';\nimport NormalizeStorage from \"./normalize-header-examples/NormalizeStorage.mjs\";\n/**\n * Override of Server Objects.\n *\n * List of Server Objects can be defined in OpenAPI 3.1 on multiple levels:\n *\n *  - OpenAPI.servers\n *  - PathItem.servers\n *  - Operation.servers\n *\n * If a servers array is specified at the OpenAPI Object level, it will be overridden by `PathItem`.servers.\n * If a servers array is specified at the Path Item Object or OpenAPI Object level, it will be overridden by Operation.servers.\n * @public\n */\n/* eslint-disable no-param-reassign */\n/**\n * @public\n */\nconst plugin = function () {\n  let {\n    storageField = 'x-normalized'\n  } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return toolbox => {\n    const {\n      namespace,\n      ancestorLineageToJSONPointer,\n      predicates\n    } = toolbox;\n    let storage;\n    return {\n      visitor: {\n        OpenApi3_1Element: {\n          enter(openapiElement) {\n            const isServersUndefined = typeof openapiElement.servers === 'undefined';\n            const isServersArrayElement = predicates.isArrayElement(openapiElement.servers);\n            const isServersEmpty = isServersArrayElement && openapiElement.servers.length === 0;\n            // @ts-ignore\n            const defaultServer = namespace.elements.Server.refract({\n              url: '/'\n            });\n            if (isServersUndefined || !isServersArrayElement) {\n              openapiElement.servers = new ServersElement([defaultServer]);\n            } else if (isServersArrayElement && isServersEmpty) {\n              openapiElement.servers.push(defaultServer);\n            }\n            storage = new NormalizeStorage(openapiElement, storageField, 'servers');\n          },\n          leave() {\n            storage = undefined;\n          }\n        },\n        PathItemElement(pathItemElement, key, parent, path, ancestors) {\n          // skip visiting this Path Item\n          if (ancestors.some(predicates.isComponentsElement)) return;\n          if (!ancestors.some(predicates.isOpenApi3_1Element)) return;\n          const pathItemJSONPointer = ancestorLineageToJSONPointer([...ancestors, parent, pathItemElement]);\n\n          // skip visiting this Path Item Object if it's already normalized\n          if (storage.includes(pathItemJSONPointer)) {\n            return;\n          }\n          const parentOpenapiElement = ancestors.find(predicates.isOpenApi3_1Element);\n          const isServersUndefined = typeof pathItemElement.servers === 'undefined';\n          const isServersArrayElement = predicates.isArrayElement(pathItemElement.servers);\n          const isServersEmpty = isServersArrayElement && pathItemElement.servers.length === 0;\n\n          // duplicate OpenAPI.servers into this Path Item object\n          if (predicates.isOpenApi3_1Element(parentOpenapiElement)) {\n            var _parentOpenapiElement;\n            const openapiServersContent = (_parentOpenapiElement = parentOpenapiElement.servers) === null || _parentOpenapiElement === void 0 ? void 0 : _parentOpenapiElement.content;\n            const openapiServers = openapiServersContent !== null && openapiServersContent !== void 0 ? openapiServersContent : [];\n            if (isServersUndefined || !isServersArrayElement) {\n              pathItemElement.servers = new PathItemServersElement(openapiServers);\n            } else if (isServersArrayElement && isServersEmpty) {\n              openapiServers.forEach(server => {\n                pathItemElement.servers.push(server);\n              });\n            }\n            storage.append(pathItemJSONPointer);\n          }\n        },\n        OperationElement(operationElement, key, parent, path, ancestors) {\n          // skip visiting this Operation\n          if (ancestors.some(predicates.isComponentsElement)) return;\n          if (!ancestors.some(predicates.isOpenApi3_1Element)) return;\n          const operationJSONPointer = ancestorLineageToJSONPointer([...ancestors, parent, operationElement]);\n\n          // skip visiting this Operation Object if it's already normalized\n          if (storage.includes(operationJSONPointer)) {\n            return;\n          }\n\n          // @TODO(vladimir.gorej@gmail.com): can be replaced by Array.prototype.findLast in future\n          const parentPathItemElement = [...ancestors].reverse().find(predicates.isPathItemElement);\n          const isServersUndefined = typeof operationElement.servers === 'undefined';\n          const isServersArrayElement = predicates.isArrayElement(operationElement.servers);\n          const isServersEmpty = isServersArrayElement && operationElement.servers.length === 0;\n          if (predicates.isPathItemElement(parentPathItemElement)) {\n            var _parentPathItemElemen;\n            const pathItemServersContent = (_parentPathItemElemen = parentPathItemElement.servers) === null || _parentPathItemElemen === void 0 ? void 0 : _parentPathItemElemen.content;\n            const pathItemServers = pathItemServersContent !== null && pathItemServersContent !== void 0 ? pathItemServersContent : [];\n            if (isServersUndefined || !isServersArrayElement) {\n              // duplicate parent PathItem.servers into this Operation object\n              operationElement.servers = new OperationServersElement(pathItemServers);\n            } else if (isServersArrayElement && isServersEmpty) {\n              pathItemServers.forEach(server => {\n                operationElement.servers.push(server);\n              });\n            }\n            storage.append(operationJSONPointer);\n          }\n        }\n      }\n    };\n  };\n};\n/* eslint-enable */\n\nexport default plugin;","map":{"version":3,"names":["PathItemServersElement","OperationServersElement","ServersElement","NormalizeStorage","plugin","storageField","arguments","length","undefined","toolbox","namespace","ancestorLineageToJSONPointer","predicates","storage","visitor","OpenApi3_1Element","enter","openapiElement","isServersUndefined","servers","isServersArrayElement","isArrayElement","isServersEmpty","defaultServer","elements","Server","refract","url","push","leave","PathItemElement","pathItemElement","key","parent","path","ancestors","some","isComponentsElement","isOpenApi3_1Element","pathItemJSONPointer","includes","parentOpenapiElement","find","_parentOpenapiElement","openapiServersContent","content","openapiServers","forEach","server","append","OperationElement","operationElement","operationJSONPointer","parentPathItemElement","reverse","isPathItemElement","_parentPathItemElemen","pathItemServersContent","pathItemServers"],"sources":["/var/www/ranvijay.capricorn.online/mohit/frontend/node_modules/@swagger-api/apidom-ns-openapi-3-1/src/refractor/plugins/normalize-servers.mjs"],"sourcesContent":["import { PathItemServersElement, OperationServersElement, ServersElement } from '@swagger-api/apidom-ns-openapi-3-0';\nimport NormalizeStorage from \"./normalize-header-examples/NormalizeStorage.mjs\";\n/**\n * Override of Server Objects.\n *\n * List of Server Objects can be defined in OpenAPI 3.1 on multiple levels:\n *\n *  - OpenAPI.servers\n *  - PathItem.servers\n *  - Operation.servers\n *\n * If a servers array is specified at the OpenAPI Object level, it will be overridden by `PathItem`.servers.\n * If a servers array is specified at the Path Item Object or OpenAPI Object level, it will be overridden by Operation.servers.\n * @public\n */\n/* eslint-disable no-param-reassign */\n/**\n * @public\n */\nconst plugin = ({\n  storageField = 'x-normalized'\n} = {}) => toolbox => {\n  const {\n    namespace,\n    ancestorLineageToJSONPointer,\n    predicates\n  } = toolbox;\n  let storage;\n  return {\n    visitor: {\n      OpenApi3_1Element: {\n        enter(openapiElement) {\n          const isServersUndefined = typeof openapiElement.servers === 'undefined';\n          const isServersArrayElement = predicates.isArrayElement(openapiElement.servers);\n          const isServersEmpty = isServersArrayElement && openapiElement.servers.length === 0;\n          // @ts-ignore\n          const defaultServer = namespace.elements.Server.refract({\n            url: '/'\n          });\n          if (isServersUndefined || !isServersArrayElement) {\n            openapiElement.servers = new ServersElement([defaultServer]);\n          } else if (isServersArrayElement && isServersEmpty) {\n            openapiElement.servers.push(defaultServer);\n          }\n          storage = new NormalizeStorage(openapiElement, storageField, 'servers');\n        },\n        leave() {\n          storage = undefined;\n        }\n      },\n      PathItemElement(pathItemElement, key, parent, path, ancestors) {\n        // skip visiting this Path Item\n        if (ancestors.some(predicates.isComponentsElement)) return;\n        if (!ancestors.some(predicates.isOpenApi3_1Element)) return;\n        const pathItemJSONPointer = ancestorLineageToJSONPointer([...ancestors, parent, pathItemElement]);\n\n        // skip visiting this Path Item Object if it's already normalized\n        if (storage.includes(pathItemJSONPointer)) {\n          return;\n        }\n        const parentOpenapiElement = ancestors.find(predicates.isOpenApi3_1Element);\n        const isServersUndefined = typeof pathItemElement.servers === 'undefined';\n        const isServersArrayElement = predicates.isArrayElement(pathItemElement.servers);\n        const isServersEmpty = isServersArrayElement && pathItemElement.servers.length === 0;\n\n        // duplicate OpenAPI.servers into this Path Item object\n        if (predicates.isOpenApi3_1Element(parentOpenapiElement)) {\n          var _parentOpenapiElement;\n          const openapiServersContent = (_parentOpenapiElement = parentOpenapiElement.servers) === null || _parentOpenapiElement === void 0 ? void 0 : _parentOpenapiElement.content;\n          const openapiServers = openapiServersContent !== null && openapiServersContent !== void 0 ? openapiServersContent : [];\n          if (isServersUndefined || !isServersArrayElement) {\n            pathItemElement.servers = new PathItemServersElement(openapiServers);\n          } else if (isServersArrayElement && isServersEmpty) {\n            openapiServers.forEach(server => {\n              pathItemElement.servers.push(server);\n            });\n          }\n          storage.append(pathItemJSONPointer);\n        }\n      },\n      OperationElement(operationElement, key, parent, path, ancestors) {\n        // skip visiting this Operation\n        if (ancestors.some(predicates.isComponentsElement)) return;\n        if (!ancestors.some(predicates.isOpenApi3_1Element)) return;\n        const operationJSONPointer = ancestorLineageToJSONPointer([...ancestors, parent, operationElement]);\n\n        // skip visiting this Operation Object if it's already normalized\n        if (storage.includes(operationJSONPointer)) {\n          return;\n        }\n\n        // @TODO(vladimir.gorej@gmail.com): can be replaced by Array.prototype.findLast in future\n        const parentPathItemElement = [...ancestors].reverse().find(predicates.isPathItemElement);\n        const isServersUndefined = typeof operationElement.servers === 'undefined';\n        const isServersArrayElement = predicates.isArrayElement(operationElement.servers);\n        const isServersEmpty = isServersArrayElement && operationElement.servers.length === 0;\n        if (predicates.isPathItemElement(parentPathItemElement)) {\n          var _parentPathItemElemen;\n          const pathItemServersContent = (_parentPathItemElemen = parentPathItemElement.servers) === null || _parentPathItemElemen === void 0 ? void 0 : _parentPathItemElemen.content;\n          const pathItemServers = pathItemServersContent !== null && pathItemServersContent !== void 0 ? pathItemServersContent : [];\n          if (isServersUndefined || !isServersArrayElement) {\n            // duplicate parent PathItem.servers into this Operation object\n            operationElement.servers = new OperationServersElement(pathItemServers);\n          } else if (isServersArrayElement && isServersEmpty) {\n            pathItemServers.forEach(server => {\n              operationElement.servers.push(server);\n            });\n          }\n          storage.append(operationJSONPointer);\n        }\n      }\n    }\n  };\n};\n/* eslint-enable */\n\nexport default plugin;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}