{"ast":null,"code":"import { cloneDeep } from '@swagger-api/apidom-core';\nimport NormalizeStorage from \"./NormalizeStorage.mjs\";\n/**\n * Override of Schema.example and Schema.examples field inside the Header Objects.\n *\n * Header Object has two fixed fields:\n *  - `example` of type `Any`\n *  - `examples` of type `Map[string, Example Object | Reference Object]`\n *\n * OpenAPI 3.1 specification excerpt that defines the override behavior:\n *\n * The example value SHALL override the example provided by the schema.\n * Furthermore, if referencing a schema that contains an example, the examples value SHALL override the example provided by the schema.\n *\n * NOTE: this plugin is idempotent\n * @public\n */\n/**\n * @public\n */\nconst plugin = function () {\n  let {\n    storageField = 'x-normalized'\n  } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return toolbox => {\n    const {\n      predicates,\n      ancestorLineageToJSONPointer\n    } = toolbox;\n    let storage;\n    return {\n      visitor: {\n        OpenApi3_1Element: {\n          enter(element) {\n            storage = new NormalizeStorage(element, storageField, 'header-examples');\n          },\n          leave() {\n            storage = undefined;\n          }\n        },\n        HeaderElement: {\n          leave(headerElement, key, parent, path, ancestors) {\n            var _headerElement$schema, _headerElement$schema2;\n            // skip visiting this Header Object\n            if (ancestors.some(predicates.isComponentsElement)) {\n              return;\n            }\n\n            // no Header.schema field present\n            if (typeof headerElement.schema === 'undefined' || !predicates.isSchemaElement(headerElement.schema)) {\n              return;\n            }\n            // Schema contains no example\n            if (typeof ((_headerElement$schema = headerElement.schema) === null || _headerElement$schema === void 0 ? void 0 : _headerElement$schema.example) === 'undefined' && typeof ((_headerElement$schema2 = headerElement.schema) === null || _headerElement$schema2 === void 0 ? void 0 : _headerElement$schema2.examples) === 'undefined') {\n              return;\n            }\n            const headerJSONPointer = ancestorLineageToJSONPointer([...ancestors, parent, headerElement]);\n\n            // skip visiting this Header Object if it's already normalized\n            if (storage.includes(headerJSONPointer)) {\n              return;\n            }\n\n            /**\n             * Header.examples and Schema.examples have preferences over the older\n             * and deprected `example` field.\n             */\n            if (typeof headerElement.examples !== 'undefined' && predicates.isObjectElement(headerElement.examples)) {\n              // @ts-ignore\n              const examples = headerElement.examples.map(example => {\n                return cloneDeep.safe(example.value);\n              });\n              if (typeof headerElement.schema.examples !== 'undefined') {\n                headerElement.schema.set('examples', examples);\n                storage.append(headerJSONPointer);\n              }\n              if (typeof headerElement.schema.example !== 'undefined') {\n                headerElement.schema.set('example', examples[0]);\n                storage.append(headerJSONPointer);\n              }\n              return;\n            }\n\n            /**\n             * Handle deprecated `example` field.\n             */\n            if (typeof headerElement.example !== 'undefined') {\n              if (typeof headerElement.schema.examples !== 'undefined') {\n                headerElement.schema.set('examples', [cloneDeep(headerElement.example)]);\n                storage.append(headerJSONPointer);\n              }\n              if (typeof headerElement.schema.example !== 'undefined') {\n                headerElement.schema.set('example', cloneDeep(headerElement.example));\n                storage.append(headerJSONPointer);\n              }\n            }\n          }\n        }\n      }\n    };\n  };\n};\nexport default plugin;","map":{"version":3,"names":["cloneDeep","NormalizeStorage","plugin","storageField","arguments","length","undefined","toolbox","predicates","ancestorLineageToJSONPointer","storage","visitor","OpenApi3_1Element","enter","element","leave","HeaderElement","headerElement","key","parent","path","ancestors","_headerElement$schema","_headerElement$schema2","some","isComponentsElement","schema","isSchemaElement","example","examples","headerJSONPointer","includes","isObjectElement","map","safe","value","set","append"],"sources":["/var/www/ranvijay.capricorn.online/mohit/frontend/node_modules/@swagger-api/apidom-ns-openapi-3-1/src/refractor/plugins/normalize-header-examples/index.mjs"],"sourcesContent":["import { cloneDeep } from '@swagger-api/apidom-core';\nimport NormalizeStorage from \"./NormalizeStorage.mjs\";\n/**\n * Override of Schema.example and Schema.examples field inside the Header Objects.\n *\n * Header Object has two fixed fields:\n *  - `example` of type `Any`\n *  - `examples` of type `Map[string, Example Object | Reference Object]`\n *\n * OpenAPI 3.1 specification excerpt that defines the override behavior:\n *\n * The example value SHALL override the example provided by the schema.\n * Furthermore, if referencing a schema that contains an example, the examples value SHALL override the example provided by the schema.\n *\n * NOTE: this plugin is idempotent\n * @public\n */\n/**\n * @public\n */\nconst plugin = ({\n  storageField = 'x-normalized'\n} = {}) => toolbox => {\n  const {\n    predicates,\n    ancestorLineageToJSONPointer\n  } = toolbox;\n  let storage;\n  return {\n    visitor: {\n      OpenApi3_1Element: {\n        enter(element) {\n          storage = new NormalizeStorage(element, storageField, 'header-examples');\n        },\n        leave() {\n          storage = undefined;\n        }\n      },\n      HeaderElement: {\n        leave(headerElement, key, parent, path, ancestors) {\n          var _headerElement$schema, _headerElement$schema2;\n          // skip visiting this Header Object\n          if (ancestors.some(predicates.isComponentsElement)) {\n            return;\n          }\n\n          // no Header.schema field present\n          if (typeof headerElement.schema === 'undefined' || !predicates.isSchemaElement(headerElement.schema)) {\n            return;\n          }\n          // Schema contains no example\n          if (typeof ((_headerElement$schema = headerElement.schema) === null || _headerElement$schema === void 0 ? void 0 : _headerElement$schema.example) === 'undefined' && typeof ((_headerElement$schema2 = headerElement.schema) === null || _headerElement$schema2 === void 0 ? void 0 : _headerElement$schema2.examples) === 'undefined') {\n            return;\n          }\n          const headerJSONPointer = ancestorLineageToJSONPointer([...ancestors, parent, headerElement]);\n\n          // skip visiting this Header Object if it's already normalized\n          if (storage.includes(headerJSONPointer)) {\n            return;\n          }\n\n          /**\n           * Header.examples and Schema.examples have preferences over the older\n           * and deprected `example` field.\n           */\n          if (typeof headerElement.examples !== 'undefined' && predicates.isObjectElement(headerElement.examples)) {\n            // @ts-ignore\n            const examples = headerElement.examples.map(example => {\n              return cloneDeep.safe(example.value);\n            });\n            if (typeof headerElement.schema.examples !== 'undefined') {\n              headerElement.schema.set('examples', examples);\n              storage.append(headerJSONPointer);\n            }\n            if (typeof headerElement.schema.example !== 'undefined') {\n              headerElement.schema.set('example', examples[0]);\n              storage.append(headerJSONPointer);\n            }\n            return;\n          }\n\n          /**\n           * Handle deprecated `example` field.\n           */\n          if (typeof headerElement.example !== 'undefined') {\n            if (typeof headerElement.schema.examples !== 'undefined') {\n              headerElement.schema.set('examples', [cloneDeep(headerElement.example)]);\n              storage.append(headerJSONPointer);\n            }\n            if (typeof headerElement.schema.example !== 'undefined') {\n              headerElement.schema.set('example', cloneDeep(headerElement.example));\n              storage.append(headerJSONPointer);\n            }\n          }\n        }\n      }\n    }\n  };\n};\nexport default plugin;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}